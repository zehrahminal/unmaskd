<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Unmask'd ‚Äî Password Tester</title>

  <!-- Use the site's shared styles so this page matches the rest of the site -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900;700&family=Open+Sans:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">

  <style>
    /* Page-specific layout that uses your site's variables from style.css */
    :root {
      /* fallback values if style.css doesn't expose them exactly */
      --page-max: 980px;
      --tester-gap: 18px;
    }

    html,body{height:100%; margin:0;}
    body {
      background: var(--section-bg, #0f1724);
      color: #fff;
      font-family: var(--ivy-sans, 'Open Sans', Arial, sans-serif);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding: 28px 18px;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    .tester-wrap {
      width: 100%;
      max-width: var(--page-max);
      margin: 10px auto 48px auto;
      background: linear-gradient(180deg, rgba(16,17,18,0.98), rgba(12,13,14,0.96));
      border-radius: 16px;
      padding: 22px;
      box-shadow: 0 12px 40px rgba(0,0,0,0.6), 0 0 30px rgba(0,255,224,0.03);
      border: 1px solid var(--window-border, #222);
    }

    /* Header (consistant with main site) */
    .tester-header {
      display:flex;
      gap:16px;
      align-items:center;
      margin-bottom: 12px;
    }
    .tester-header .logo {
      height:56px;
      width:auto;
      filter: drop-shadow(0 0 12px #00ffe055);
    }
    .tester-header .title-block {
      display:flex;
      flex-direction:column;
    }
    .tester-header h1 {
      margin:0;
      font-family: var(--ivy-serif, 'Playfair Display', serif);
      font-size:1.4rem;
      font-weight:900;
      color: var(--neon-mint, #00ffe0);
    }
    .tester-header p.desc {
      margin:4px 0 0 0;
      color: #cfeee9;
      font-size:0.95rem;
    }

    /* Layout */
    .row {
      display:flex;
      gap: var(--tester-gap);
      align-items:flex-start;
      flex-wrap:wrap;
      margin-top:14px;
    }
    .left { flex:1 1 360px; min-width:280px; }
    .right { flex:1 1 320px; min-width:260px; }

    label.small { font-size:0.9rem; color: var(--neon-mint-alpha, #00ffe0aa); display:block; margin-bottom:8px; }

    .inputwrap {
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));
      border-radius: 12px;
      padding:10px;
      display:flex;
      gap:8px;
      align-items:center;
      border: 1px solid rgba(255,255,255,0.03);
    }
    input[type="password"], input[type="text"]{
      background:transparent; border:0; outline:0; color:inherit; font-size:16px; width:100%;
      padding:6px 0;
      font-family: var(--ivy-sans, 'Open Sans', Arial, sans-serif);
    }

    .controls { display:flex; gap:10px; margin-top:12px; flex-wrap:wrap; }
    .btn { display:inline-block; background: var(--gradient, linear-gradient(120deg,#00ffe0 60%,#ff4d6d 100%)); color:#101010; font-weight:900; padding:10px 16px; border-radius:999px; border:none; cursor:pointer; text-decoration:none; }
    .btn.ghost { background:transparent; border:1.5px solid var(--window-border,#222); color:var(--neon-mint,#00ffe0); box-shadow:none; }

    .meter { height:14px; background: rgba(255,255,255,0.03); border-radius:10px; overflow:hidden; margin-top:12px; }
    .meter > i { display:block; height:100%; width:0; transition: width 700ms cubic-bezier(.2,.9,.3,1); background: linear-gradient(90deg,#ff7a7a,#ffd66d); }

    .stats { margin-top:12px; display:flex; gap:10px; flex-wrap:wrap; }
    .stat { background: rgba(255,255,255,0.01); padding:12px; border-radius:10px; flex:1 1 140px; min-width:120px; color:#cfeee9; }
    .stat b { display:block; color:var(--neon-mint,#00ffe0); margin-bottom:6px; font-size:14px; }

    .tips { margin-top:14px; color:#cfeee9; }
    .tips ul { margin:8px 0 0 18px; padding:0; }
    .tips li { margin:6px 0; }

    .right .card { background:transparent; padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,0.03); margin-bottom:12px; color:#cfeee9; }
    .badge { font-size:11px; padding:6px 8px; border-radius:999px; background:rgba(255,255,255,0.03); color:var(--neon-mint); display:inline-block; }

    .footer { display:flex; justify-content:space-between; align-items:center; margin-top:16px; gap:12px; color:#cfeee9; font-size:13px; flex-wrap:wrap; }

    /* Back to home button align top right on larger screens */
    .back-home {
      display:inline-block;
      margin-left:auto;
      text-decoration:none;
      padding:8px 14px;
      border-radius:999px;
      background:var(--gradient, linear-gradient(120deg,#00ffe0 60%,#ff4d6d 100%));
      color:#101010;
      font-weight:900;
    }

    @media (max-width:840px){
      .tester-header { flex-direction:column; align-items:flex-start; gap:8px; }
      .back-home { margin-left:0; }
      .row { flex-direction:column; }
    }
  </style>
</head>
<body>
  <main class="tester-wrap" role="main" aria-labelledby="title">
    <header class="tester-header" role="banner">
      <img src="images/new logo.png" alt="Unmask'd Logo" class="logo" />
      <div class="title-block">
        <h1 id="title">üîê Password Tester</h1>
        <p class="desc">Check how crackable a password looks. All calculations run in the browser ‚Äî nothing is sent anywhere.</p>
      </div>

      <!-- Return to Home -->
      <a href="index.html" class="back-home" aria-label="Back to Home">Back to Home</a>
    </header>

    <div class="row">
      <!-- left column -->
      <div class="left">
        <label class="small" for="pwd">Type a password to test</label>
        <div class="inputwrap" role="group" aria-labelledby="pwd">
          <input id="pwd" type="password" autocomplete="new-password" placeholder="type password..." aria-describedby="strengthLabel" />
          <button id="toggle" class="btn ghost" title="show/hide" aria-pressed="false">show</button>
          <button id="copy" class="btn ghost" title="copy password">copy</button>
        </div>

        <div class="meter" aria-hidden="true"><i id="meterbar" style="width:0%"></i></div>

        <div class="controls" role="group" aria-label="options">
          <button class="btn" id="randomBtn">generate random</button>
          <button class="btn ghost" id="clearBtn">clear</button>
        </div>

        <div class="stats" aria-live="polite">
          <div class="stat">
            <b id="strengthLabel">strength: ‚Äî</b>
            <div id="strengthNote">enter a password to see results</div>
          </div>
          <div class="stat">
            <b>entropy</b>
            <div id="entropy">‚Äî bits</div>
          </div>
          <div class="stat">
            <b>crack time (offline GPU)</b>
            <div id="crackFast">‚Äî</div>
          </div>
          <div class="stat">
            <b>crack time (online throttled)</b>
            <div id="crackSlow">‚Äî</div>
          </div>
        </div>

        <div class="tips" aria-live="polite">
          <strong>quick tips</strong>
          <ul id="adviceList">
            <li>use long passphrases ‚â• 12 chars</li>
            <li>mix letters, numbers & symbols</li>
            <li>avoid common words or repeated patterns</li>
          </ul>
        </div>
      </div>

      <!-- right column -->
      <aside class="right" aria-label="analysis">
        <div class="card" role="region" aria-labelledby="analysisTitle">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div class="badge">what we check</div>
              <h2 id="analysisTitle" style="margin:6px 0 0 0;font-size:15px;color:var(--neon-mint)">analysis</h2>
            </div>
            <div style="text-align:right;color:var(--neon-mint-alpha, #00ffe0aa);font-size:12px">privacy: local only</div>
          </div>

          <ul id="checks" style="margin:12px 0 0 16px;color:#cfeee9;font-size:13px;line-height:1.45">
            <li id="check-length">length: ‚Äî</li>
            <li id="check-chars">character variety: ‚Äî</li>
            <li id="check-common">common password check: ‚Äî</li>
            <li id="check-pattern">pattern / repeats: ‚Äî</li>
            <li id="check-sequence">keyboard/sequence: ‚Äî</li>
          </ul>
        </div>

        <div class="card" style="margin-top:12px">
          <div style="color:#cfeee9;font-size:13px">
            <strong>how the estimates work</strong>
            <p style="margin:8px 0 0 0;color:var(--neon-mint-alpha, #00ffe0aa)">We estimate entropy (bits) from the set of characters used, then calculate how long it would take to guess the password at two speeds: <em>offline gpu</em> (1e10 guesses/sec ‚Äî fast attacker) and <em>online</em> (100 guesses/sec ‚Äî rate-limited). These are conservative, illustrative numbers ‚Äî treat them as guidance, not a guarantee.</p>
          </div>
        </div>
      </aside>
    </div>

    <div class="footer">
      <div class="note">small common-password check included. all analysis runs locally in the browser.</div>
      <div style="font-size:12px;color:var(--neon-mint)">made for Unmask'd</div>
    </div>
  </main>

  <script>
  /*
    Password tester logic (same behavior as your provided page)
    Runs fully in-browser, no network requests.
  */
  (function(){
    const pwdInput = document.getElementById('pwd');
    const meterBar = document.getElementById('meterbar');
    const strengthLabel = document.getElementById('strengthLabel');
    const strengthNote = document.getElementById('strengthNote');
    const entropyEl = document.getElementById('entropy');
    const crackFast = document.getElementById('crackFast');
    const crackSlow = document.getElementById('crackSlow');
    const adviceList = document.getElementById('adviceList');
    const checks = {
      length: document.getElementById('check-length'),
      chars: document.getElementById('check-chars'),
      common: document.getElementById('check-common'),
      pattern: document.getElementById('check-pattern'),
      seq: document.getElementById('check-sequence')
    };

    const randomBtn = document.getElementById('randomBtn');
    const clearBtn = document.getElementById('clearBtn');
    const toggle = document.getElementById('toggle');
    const copyBtn = document.getElementById('copy');

    toggle.addEventListener('click', () => {
      const showing = pwdInput.type === 'text';
      pwdInput.type = showing ? 'password' : 'text';
      toggle.textContent = showing ? 'show' : 'hide';
      toggle.setAttribute('aria-pressed', String(!showing));
    });

    copyBtn.addEventListener('click', () => {
      navigator.clipboard?.writeText(pwdInput.value).then(()=> {
        const prev = copyBtn.textContent;
        copyBtn.textContent = 'copied';
        setTimeout(()=> copyBtn.textContent = prev,1200);
      }).catch(()=> {
        // ignore
      });
    });

    clearBtn.addEventListener('click', ()=> {
      pwdInput.value = '';
      update();
    });

    randomBtn.addEventListener('click', ()=> {
      pwdInput.value = generateRandomPass(14);
      update();
    });

    const commonPasswords = [
      "123456","password","123456789","12345678","qwerty","abc123","111111","iloveyou","admin","welcome",
      "password1","1234","letmein","monkey","dragon","passw0rd","master"
    ];

    function generateRandomPass(len=12){
      const chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()-_=+[]{};:,.<>?";
      let s = '';
      for (let i=0;i<len;i++) s += chars[Math.floor(Math.random()*chars.length)];
      return s;
    }

    pwdInput.addEventListener('input', update);
    update();

    function update(){
      const pw = pwdInput.value || '';
      if (!pw) {
        meterBar.style.width = '0%';
        strengthLabel.textContent = 'strength: ‚Äî';
        strengthNote.textContent = 'enter a password to see results';
        entropyEl.textContent = '‚Äî bits';
        crackFast.textContent = '‚Äî';
        crackSlow.textContent = '‚Äî';
        Object.values(checks).forEach(el => el.textContent = el.id.replace('check-','') + ': ‚Äî');
        renderSuggestions(['use long passphrases ‚â• 12 chars','mix letters, numbers & symbols','avoid common words']);
        return;
      }

      const hasLower = /[a-z]/.test(pw);
      const hasUpper = /[A-Z]/.test(pw);
      const hasDigit = /[0-9]/.test(pw);
      const hasSymbol = /[^A-Za-z0-9]/.test(pw);
      const hasUnicode = /[^\x00-\x7F]/.test(pw);

      let poolSize = 0;
      if (hasLower) poolSize += 26;
      if (hasUpper) poolSize += 26;
      if (hasDigit) poolSize += 10;
      if (hasSymbol) poolSize += 32;
      if (hasUnicode) poolSize += 100;

      const len = pw.length;
      checks.length.textContent = `length: ${len} char${len===1?'':'s'}`;
      checks.chars.textContent = `character variety: ${hasLower? 'lower ':''
        }${hasUpper? 'upper ':''}${hasDigit? 'digits ':''}${hasSymbol? 'symbols ':''}`.trim() || 'none';

      const entropy = poolSize > 1 ? (len * Math.log2(poolSize)) : 0;
      entropyEl.textContent = `${Math.round(entropy)} bits`;

      let strength = 'very weak';
      const e = entropy;
      if (commonPasswords.includes(pw.toLowerCase())) {
        strength = 'very weak';
      } else if (e < 28) {
        strength = 'very weak';
      } else if (e < 36) {
        strength = 'weak';
      } else if (e < 60) {
        strength = 'moderate';
      } else if (e < 80) {
        strength = 'strong';
      } else {
        strength = 'very strong';
      }
      strengthLabel.textContent = `strength: ${strength}`;

      const maxEntropy = 100;
      const pct = Math.min(100, Math.round((entropy / maxEntropy) * 100));
      meterBar.style.width = pct + '%';
      if (pct < 25) meterBar.style.background = 'linear-gradient(90deg,#ef4444,#ff7a7a)';
      else if (pct < 50) meterBar.style.background = 'linear-gradient(90deg,#f59e0b,#ffd66d)';
      else if (pct < 75) meterBar.style.background = 'linear-gradient(90deg,#06b6d4,#7dd3fc)';
      else meterBar.style.background = 'linear-gradient(90deg,#10b981,#60a5fa)';

      const guesses = Math.pow(2, entropy);
      const speeds = { offline: 1e10, online: 100 };
      crackFast.textContent = formatDuration(guesses / speeds.offline);
      crackSlow.textContent = formatDuration(guesses / speeds.online);

      checks.common.textContent = commonPasswords.includes(pw.toLowerCase()) ? 'common password: yes ‚Äî avoid' : 'common password: not in small list';
      checks.pattern.textContent = detectPatterns(pw) ? 'pattern / repeats: detected' : 'pattern / repeats: none detected';
      checks.seq.textContent = detectSequence(pw) ? 'sequence: likely' : 'sequence: none';

      const suggestions = generateSuggestions(pw, {len, hasLower, hasUpper, hasDigit, hasSymbol});
      renderSuggestions(suggestions);
    }

    function formatDuration(seconds){
      if (!isFinite(seconds) || seconds <= 0) return 'instantly';
      const units = [
        {s: 31557600, name:'years'},
        {s: 86400, name:'days'},
        {s: 3600, name:'hours'},
        {s: 60, name:'minutes'},
        {s: 1, name:'seconds'}
      ];
      for (const u of units){
        const v = Math.floor(seconds / u.s);
        if (v >= 1) return `${v} ${u.name}`;
      }
      return 'less than a second';
    }

    function detectPatterns(s){
      if (/^(.)\1+$/.test(s)) return true;
      for (let size=1; size<=Math.floor(s.length/2); size++){
        let chunk = s.slice(0,size);
        if (chunk.repeat(Math.floor(s.length/size)) === s) return true;
      }
      if (/qwerty|asdf|zxcv|1234|4321/.test(s.toLowerCase())) return true;
      return false;
    }

    function detectSequence(s){
      const seqs = [
        'abcdefghijklmnopqrstuvwxyz',
        '0123456789',
        'qwertyuiopasdfghjklzxcvbnm'
      ];
      const lower = s.toLowerCase();
      for (const seq of seqs){
        for (let i=0;i<seq.length-2;i++){
          const piece = seq.substr(i,3);
          if (lower.includes(piece)) return true;
          const rev = piece.split('').reverse().join('');
          if (lower.includes(rev)) return true;
        }
      }
      return false;
    }

    function generateSuggestions(pw, props){
      const s = [];
      if (commonPasswords.includes(pw.toLowerCase())) s.push('this is a very common password ‚Äî pick something unique');
      if (props.len < 12) s.push('use at least 12 characters; passphrases are easier to remember');
      if (!props.hasUpper) s.push('add some uppercase letters');
      if (!props.hasDigit) s.push('add numbers (e.g., separate words with a number)');
      if (!props.hasSymbol) s.push('add a symbol or punctuation for extra entropy');
      if (detectPatterns(pw)) s.push('avoid repeated patterns or short repeated chunks');
      if (detectSequence(pw)) s.push('avoid obvious sequences like "1234" or "abcd"');
      if (s.length === 0) s.push('looks solid ‚Äî consider a password manager to store it safely');
      return s;
    }

    function renderSuggestions(list){
      adviceList.innerHTML = '';
      list.forEach(it=>{
        const li = document.createElement('li');
        li.textContent = it;
        adviceList.appendChild(li);
      });
    }

    // prevent Enter from submitting form or navigating
    document.addEventListener('keydown', (e)=>{
      if (e.key === 'Enter' && document.activeElement === pwdInput) {
        e.preventDefault();
      }
    });

  })();
  </script>
</body>
</html>
